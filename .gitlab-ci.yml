image: registry.gitlab.com/han-thesis/fluids:be998501f

stages:
  - test
  - publish

unittest:
  type: test

  script:
    - mkdir -p build
    - cd build
    - cmake -DCMAKE_BUILD_TYPE=Release ..
    - make
    - ./test/test_main

release:
  type: publish

  script:
    - mkdir -p build
    - cd build
    - cmake -DCMAKE_BUILD_TYPE=Release ..
    - make
    - cpack -G TGZ
    - mv *.tar.gz ..
    - cd ..

  artifacts:
    paths:
      - ./*.tar.gz